<!-- HTML header for doxygen 1.13.2-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Docs: SplitMerge_LSS Class Reference</title>
<!--BEGIN PROJECT_ICON-->
<link rel="icon" href="$projecticon" type="image/x-icon" />
<!--END PROJECT_ICON-->
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<!--BEGIN COPY_CLIPBOARD-->
<script type="text/javascript" src="clipboard.js"></script>
<!--END COPY_CLIPBOARD-->
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="https://cdn.jsdelivr.net/gh/jothepro/doxygen-awesome-css@v2.3.4/doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="https://cdn.jsdelivr.net/gh/jothepro/doxygen-awesome-css@v2.3.4/doxygen-awesome-sidebar-only.css" rel="stylesheet" type="text/css"/>
<link href="https://cdn.jsdelivr.net/gh/jothepro/doxygen-awesome-css@v2.3.4/doxygen-awesome-sidebar-only-darkmode-toggle.css" rel="stylesheet" type="text/css"/>
<link href="custom.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Docs
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('classSplitMerge__LSS.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pri-methods">Private Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="classSplitMerge__LSS-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">SplitMerge_LSS Class Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Locality Sensitive Sampling (LSS) Split-Merge sampler for Bayesian nonparametric models.  
 <a href="classSplitMerge__LSS.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="splitmerge__LSS_8hpp_source.html">splitmerge_LSS.hpp</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for SplitMerge_LSS:</div>
<div class="dyncontent">
 <div class="center">
  <img src="classSplitMerge__LSS.png" usemap="#SplitMerge_5FLSS_map" alt=""/>
  <map id="SplitMerge_5FLSS_map" name="SplitMerge_5FLSS_map">
<area href="classSampler.html" title="Abstract base class for MCMC sampler implementations." alt="Sampler" shape="rect" coords="0,0,103,24"/>
  </map>
</div></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a595c757322a9ad77de02a683f1617377" id="r_a595c757322a9ad77de02a683f1617377"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSplitMerge__LSS.html#a595c757322a9ad77de02a683f1617377">SplitMerge_LSS</a> (<a class="el" href="classData.html">Data</a> &amp;d, <a class="el" href="structParams.html">Params</a> &amp;p, <a class="el" href="classLikelihood.html">Likelihood</a> &amp;l, <a class="el" href="classProcess.html">Process</a> &amp;pr, bool <a class="el" href="classSplitMerge__LSS.html#aec5dd1754aebe6d9898f31b8f51eade3">shuffle</a>)</td></tr>
<tr class="memdesc:a595c757322a9ad77de02a683f1617377"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructor for LSS (Locality Sensitive Sampling) Split-Merge sampler.  <br /></td></tr>
<tr class="separator:a595c757322a9ad77de02a683f1617377"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a766bfa11be282aeb39428556c65e0296" id="r_a766bfa11be282aeb39428556c65e0296"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSplitMerge__LSS.html#a766bfa11be282aeb39428556c65e0296">step</a> () override</td></tr>
<tr class="memdesc:a766bfa11be282aeb39428556c65e0296"><td class="mdescLeft">&#160;</td><td class="mdescRight">Perform one iteration of the LSS Split-Merge algorithm.  <br /></td></tr>
<tr class="separator:a766bfa11be282aeb39428556c65e0296"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1375b8d9efe2e2120592436e36bbba04" id="r_a1375b8d9efe2e2120592436e36bbba04"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSplitMerge__LSS.html#a1375b8d9efe2e2120592436e36bbba04">get_accepted_split</a> () const</td></tr>
<tr class="memdesc:a1375b8d9efe2e2120592436e36bbba04"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get number of accepted split moves for diagnostics.  <br /></td></tr>
<tr class="separator:a1375b8d9efe2e2120592436e36bbba04"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa8a4414bb201370286b0dbad7e73ea68" id="r_aa8a4414bb201370286b0dbad7e73ea68"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSplitMerge__LSS.html#aa8a4414bb201370286b0dbad7e73ea68">get_accepted_merge</a> () const</td></tr>
<tr class="memdesc:aa8a4414bb201370286b0dbad7e73ea68"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get number of accepted merge moves for diagnostics.  <br /></td></tr>
<tr class="separator:aa8a4414bb201370286b0dbad7e73ea68"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac4549dbcb5b175229392e7aab4ed694d" id="r_ac4549dbcb5b175229392e7aab4ed694d"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSplitMerge__LSS.html#ac4549dbcb5b175229392e7aab4ed694d">get_accepted_shuffle</a> () const</td></tr>
<tr class="memdesc:ac4549dbcb5b175229392e7aab4ed694d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get number of accepted shuffle moves for diagnostics.  <br /></td></tr>
<tr class="separator:ac4549dbcb5b175229392e7aab4ed694d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_classSampler"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_classSampler')"><img src="closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="classSampler.html">Sampler</a></td></tr>
<tr class="memitem:a4800cc1f9d2718968f5957ca99eee5b1 inherit pub_methods_classSampler" id="r_a4800cc1f9d2718968f5957ca99eee5b1"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampler.html#a4800cc1f9d2718968f5957ca99eee5b1">Sampler</a> (<a class="el" href="classData.html">Data</a> &amp;d, const <a class="el" href="structParams.html">Params</a> &amp;p, const <a class="el" href="classLikelihood.html">Likelihood</a> &amp;l, <a class="el" href="classProcess.html">Process</a> &amp;pr)</td></tr>
<tr class="memdesc:a4800cc1f9d2718968f5957ca99eee5b1 inherit pub_methods_classSampler"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructor initializing sampler with required components.  <br /></td></tr>
<tr class="separator:a4800cc1f9d2718968f5957ca99eee5b1 inherit pub_methods_classSampler"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a211a2f7cb64b2adf3a8c66f92abf8f7d inherit pub_methods_classSampler" id="r_a211a2f7cb64b2adf3a8c66f92abf8f7d"><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampler.html#a211a2f7cb64b2adf3a8c66f92abf8f7d">~Sampler</a> ()=default</td></tr>
<tr class="memdesc:a211a2f7cb64b2adf3a8c66f92abf8f7d inherit pub_methods_classSampler"><td class="mdescLeft">&#160;</td><td class="mdescRight">Virtual destructor for proper cleanup of derived classes.  <br /></td></tr>
<tr class="separator:a211a2f7cb64b2adf3a8c66f92abf8f7d inherit pub_methods_classSampler"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pri-methods" name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr class="memitem:a72d1782c9ef51178895107d575fc4171" id="r_a72d1782c9ef51178895107d575fc4171"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSplitMerge__LSS.html#a72d1782c9ef51178895107d575fc4171">choose_indeces</a> (bool similarity=false)</td></tr>
<tr class="memdesc:a72d1782c9ef51178895107d575fc4171"><td class="mdescLeft">&#160;</td><td class="mdescRight">Randomly select two observations for split-merge proposal.  <br /></td></tr>
<tr class="separator:a72d1782c9ef51178895107d575fc4171"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9db1efefb6e1fd16e8be534c540178ba" id="r_a9db1efefb6e1fd16e8be534c540178ba"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSplitMerge__LSS.html#a9db1efefb6e1fd16e8be534c540178ba">choose_clusters_shuffle</a> ()</td></tr>
<tr class="memdesc:a9db1efefb6e1fd16e8be534c540178ba"><td class="mdescLeft">&#160;</td><td class="mdescRight">Select clusters for shuffle move.  <br /></td></tr>
<tr class="separator:a9db1efefb6e1fd16e8be534c540178ba"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac5252791b0a9a1a9b174421205a33c7d" id="r_ac5252791b0a9a1a9b174421205a33c7d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSplitMerge__LSS.html#ac5252791b0a9a1a9b174421205a33c7d">sequential_allocation</a> (int iterations, bool only_probabilities=false, bool sequential=true)</td></tr>
<tr class="memdesc:ac5252791b0a9a1a9b174421205a33c7d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generate proposal state via sequential allocation.  <br /></td></tr>
<tr class="separator:ac5252791b0a9a1a9b174421205a33c7d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6aed8447d79a5834366538cfe55371f4" id="r_a6aed8447d79a5834366538cfe55371f4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSplitMerge__LSS.html#a6aed8447d79a5834366538cfe55371f4">split_move</a> ()</td></tr>
<tr class="memdesc:a6aed8447d79a5834366538cfe55371f4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Execute a split move using LSS.  <br /></td></tr>
<tr class="separator:a6aed8447d79a5834366538cfe55371f4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4feef4466a3f38f2514e757dd549c01f" id="r_a4feef4466a3f38f2514e757dd549c01f"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSplitMerge__LSS.html#a4feef4466a3f38f2514e757dd549c01f">compute_acceptance_ratio_split</a> (double likelihood_old_cluster)</td></tr>
<tr class="memdesc:a4feef4466a3f38f2514e757dd549c01f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute acceptance ratio for LSS split move.  <br /></td></tr>
<tr class="separator:a4feef4466a3f38f2514e757dd549c01f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a592b28bad845e868b2baef627472a8c3" id="r_a592b28bad845e868b2baef627472a8c3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSplitMerge__LSS.html#a592b28bad845e868b2baef627472a8c3">merge_move</a> ()</td></tr>
<tr class="memdesc:a592b28bad845e868b2baef627472a8c3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Execute a merge move using LSS.  <br /></td></tr>
<tr class="separator:a592b28bad845e868b2baef627472a8c3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a424feff7106b2f43492078d82cf1434f" id="r_a424feff7106b2f43492078d82cf1434f"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSplitMerge__LSS.html#a424feff7106b2f43492078d82cf1434f">compute_acceptance_ratio_merge</a> (double likelihood_old_ci, double likelihood_old_cj)</td></tr>
<tr class="memdesc:a424feff7106b2f43492078d82cf1434f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute acceptance ratio for LSS merge move.  <br /></td></tr>
<tr class="separator:a424feff7106b2f43492078d82cf1434f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aec5dd1754aebe6d9898f31b8f51eade3" id="r_aec5dd1754aebe6d9898f31b8f51eade3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSplitMerge__LSS.html#aec5dd1754aebe6d9898f31b8f51eade3">shuffle</a> ()</td></tr>
<tr class="memdesc:aec5dd1754aebe6d9898f31b8f51eade3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Execute a shuffle move using LSS.  <br /></td></tr>
<tr class="separator:aec5dd1754aebe6d9898f31b8f51eade3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9305380b10376e14313f9f1d708329a2" id="r_a9305380b10376e14313f9f1d708329a2"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSplitMerge__LSS.html#a9305380b10376e14313f9f1d708329a2">compute_acceptance_ratio_shuffle</a> (double likelihood_old_ci, double likelihood_old_cj, int old_ci_size, int old_cj_size)</td></tr>
<tr class="memdesc:a9305380b10376e14313f9f1d708329a2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute acceptance ratio for LSS shuffle move.  <br /></td></tr>
<tr class="separator:a9305380b10376e14313f9f1d708329a2"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pri-attribs" name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:a99554021bcc51e39bc61dde55c7961b8" id="r_a99554021bcc51e39bc61dde55c7961b8"><td class="memItemLeft" align="right" valign="top">std::mt19937&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSplitMerge__LSS.html#a99554021bcc51e39bc61dde55c7961b8">gen</a></td></tr>
<tr class="memdesc:a99554021bcc51e39bc61dde55c7961b8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Mersenne Twister random number generator for sampling operations.  <br /></td></tr>
<tr class="separator:a99554021bcc51e39bc61dde55c7961b8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac7a1b9806e8f045ca1b3e3c4f282c233" id="r_ac7a1b9806e8f045ca1b3e3c4f282c233"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSplitMerge__LSS.html#ac7a1b9806e8f045ca1b3e3c4f282c233">idx_i</a></td></tr>
<tr class="memdesc:ac7a1b9806e8f045ca1b3e3c4f282c233"><td class="mdescLeft">&#160;</td><td class="mdescRight">Index of first randomly chosen observation.  <br /></td></tr>
<tr class="separator:ac7a1b9806e8f045ca1b3e3c4f282c233"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8c98c80c273d7bb82e5e17207dcbb90d" id="r_a8c98c80c273d7bb82e5e17207dcbb90d"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSplitMerge__LSS.html#a8c98c80c273d7bb82e5e17207dcbb90d">idx_j</a></td></tr>
<tr class="memdesc:a8c98c80c273d7bb82e5e17207dcbb90d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Index of second randomly chosen observation.  <br /></td></tr>
<tr class="separator:a8c98c80c273d7bb82e5e17207dcbb90d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afb31363a48582dbf41b5d1749623d7df" id="r_afb31363a48582dbf41b5d1749623d7df"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSplitMerge__LSS.html#afb31363a48582dbf41b5d1749623d7df">ci</a></td></tr>
<tr class="memdesc:afb31363a48582dbf41b5d1749623d7df"><td class="mdescLeft">&#160;</td><td class="mdescRight">Cluster assignment of first observation.  <br /></td></tr>
<tr class="separator:afb31363a48582dbf41b5d1749623d7df"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6ced96fbbfdd52d9b0ae8682b83e5640" id="r_a6ced96fbbfdd52d9b0ae8682b83e5640"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSplitMerge__LSS.html#a6ced96fbbfdd52d9b0ae8682b83e5640">cj</a></td></tr>
<tr class="memdesc:a6ced96fbbfdd52d9b0ae8682b83e5640"><td class="mdescLeft">&#160;</td><td class="mdescRight">Cluster assignment of second observation.  <br /></td></tr>
<tr class="separator:a6ced96fbbfdd52d9b0ae8682b83e5640"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afa850a59ac5189d46ea4f34babcb41e0" id="r_afa850a59ac5189d46ea4f34babcb41e0"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSplitMerge__LSS.html#afa850a59ac5189d46ea4f34babcb41e0">shuffle_bool</a> = false</td></tr>
<tr class="memdesc:afa850a59ac5189d46ea4f34babcb41e0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Flag to enable shuffle moves (Mena and Martinez, 2014)  <br /></td></tr>
<tr class="separator:afa850a59ac5189d46ea4f34babcb41e0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5d32095728297ce218120e1bf6454cee" id="r_a5d32095728297ce218120e1bf6454cee"><td class="memItemLeft" align="right" valign="top">Eigen::VectorXi&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSplitMerge__LSS.html#a5d32095728297ce218120e1bf6454cee">launch_state</a></td></tr>
<tr class="memdesc:a5d32095728297ce218120e1bf6454cee"><td class="mdescLeft">&#160;</td><td class="mdescRight">Launch state for sequential allocation.  <br /></td></tr>
<tr class="separator:a5d32095728297ce218120e1bf6454cee"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a339dbb5c0d5dcce9cf351c0dc34a29db" id="r_a339dbb5c0d5dcce9cf351c0dc34a29db"><td class="memItemLeft" align="right" valign="top">Eigen::VectorXi&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSplitMerge__LSS.html#a339dbb5c0d5dcce9cf351c0dc34a29db">S</a></td></tr>
<tr class="memdesc:a339dbb5c0d5dcce9cf351c0dc34a29db"><td class="mdescLeft">&#160;</td><td class="mdescRight">Indices of observations in clusters ci and cj.  <br /></td></tr>
<tr class="separator:a339dbb5c0d5dcce9cf351c0dc34a29db"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8469a38fe1119d98269a4373cc3d2063" id="r_a8469a38fe1119d98269a4373cc3d2063"><td class="memItemLeft" align="right" valign="top">Eigen::VectorXi&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSplitMerge__LSS.html#a8469a38fe1119d98269a4373cc3d2063">original_allocations</a></td></tr>
<tr class="memdesc:a8469a38fe1119d98269a4373cc3d2063"><td class="mdescLeft">&#160;</td><td class="mdescRight">Original cluster assignments before move proposal.  <br /></td></tr>
<tr class="separator:a8469a38fe1119d98269a4373cc3d2063"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ace64a91822dea799445ec13c33d54e3c" id="r_ace64a91822dea799445ec13c33d54e3c"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSplitMerge__LSS.html#ace64a91822dea799445ec13c33d54e3c">log_split_gibbs_prob</a> = 0</td></tr>
<tr class="memdesc:ace64a91822dea799445ec13c33d54e3c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Log probability of generating current state via sequential allocation (split direction)  <br /></td></tr>
<tr class="separator:ace64a91822dea799445ec13c33d54e3c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a16f2309b47927932ba6ec41a64665bd9" id="r_a16f2309b47927932ba6ec41a64665bd9"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSplitMerge__LSS.html#a16f2309b47927932ba6ec41a64665bd9">log_merge_gibbs_prob</a> = 0</td></tr>
<tr class="memdesc:a16f2309b47927932ba6ec41a64665bd9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Log probability of generating current state via sequential allocation (merge direction)  <br /></td></tr>
<tr class="separator:a16f2309b47927932ba6ec41a64665bd9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a334e39e5d45c07d7ab1206ea42400af5" id="r_a334e39e5d45c07d7ab1206ea42400af5"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSplitMerge__LSS.html#a334e39e5d45c07d7ab1206ea42400af5">accepted_split</a> = 0</td></tr>
<tr class="separator:a334e39e5d45c07d7ab1206ea42400af5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a686d52f723a414c87007d64e647df358" id="r_a686d52f723a414c87007d64e647df358"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSplitMerge__LSS.html#a686d52f723a414c87007d64e647df358">accepted_merge</a> = 0</td></tr>
<tr class="separator:a686d52f723a414c87007d64e647df358"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8697a2a479ff23e3ea6ac59758a26396" id="r_a8697a2a479ff23e3ea6ac59758a26396"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSplitMerge__LSS.html#a8697a2a479ff23e3ea6ac59758a26396">accepted_shuffle</a> = 0</td></tr>
<tr class="separator:a8697a2a479ff23e3ea6ac59758a26396"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="inherited" name="inherited"></a>
Additional Inherited Members</h2></td></tr>
<tr class="inherit_header pro_attribs_classSampler"><td colspan="2" onclick="javascript:toggleInherit('pro_attribs_classSampler')"><img src="closed.png" alt="-"/>&#160;Protected Attributes inherited from <a class="el" href="classSampler.html">Sampler</a></td></tr>
<tr class="memitem:a82728aa82b611766bc21cbfbb04e83b5 inherit pro_attribs_classSampler" id="r_a82728aa82b611766bc21cbfbb04e83b5"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classData.html">Data</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampler.html#a82728aa82b611766bc21cbfbb04e83b5">data</a></td></tr>
<tr class="memdesc:a82728aa82b611766bc21cbfbb04e83b5 inherit pro_attribs_classSampler"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reference to the data object containing observations and current allocations.  <br /></td></tr>
<tr class="separator:a82728aa82b611766bc21cbfbb04e83b5 inherit pro_attribs_classSampler"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a82d788501df27a3490c27085e5c6a218 inherit pro_attribs_classSampler" id="r_a82d788501df27a3490c27085e5c6a218"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="structParams.html">Params</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampler.html#a82d788501df27a3490c27085e5c6a218">params</a></td></tr>
<tr class="memdesc:a82d788501df27a3490c27085e5c6a218 inherit pro_attribs_classSampler"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reference to the parameters object containing model hyperparameters and MCMC settings.  <br /></td></tr>
<tr class="separator:a82d788501df27a3490c27085e5c6a218 inherit pro_attribs_classSampler"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1572ed0ff1a7ace0f1c6b60954200d8c inherit pro_attribs_classSampler" id="r_a1572ed0ff1a7ace0f1c6b60954200d8c"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="classLikelihood.html">Likelihood</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampler.html#a1572ed0ff1a7ace0f1c6b60954200d8c">likelihood</a></td></tr>
<tr class="memdesc:a1572ed0ff1a7ace0f1c6b60954200d8c inherit pro_attribs_classSampler"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reference to the likelihood computation object for evaluating cluster assignments.  <br /></td></tr>
<tr class="separator:a1572ed0ff1a7ace0f1c6b60954200d8c inherit pro_attribs_classSampler"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8ec54ff9fe8f22c8514496d6f3b998d0 inherit pro_attribs_classSampler" id="r_a8ec54ff9fe8f22c8514496d6f3b998d0"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classProcess.html">Process</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampler.html#a8ec54ff9fe8f22c8514496d6f3b998d0">process</a></td></tr>
<tr class="memdesc:a8ec54ff9fe8f22c8514496d6f3b998d0 inherit pro_attribs_classSampler"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reference to the stochastic process object (<a class="el" href="classDP.html" title="Dirichlet Process class for Bayesian nonparametric clustering.">DP</a>, <a class="el" href="classNGGP.html" title="Normalized Generalized Gamma Process class for Bayesian nonparametric clustering.">NGGP</a>, <a class="el" href="classDPW.html" title="Dirichlet Process with spatial Weights class for spatially-aware Bayesian nonparametric clustering.">DPW</a>, <a class="el" href="classNGGPW.html" title="Normalized Generalized Gamma Process with spatial Weights class for spatially-aware Bayesian nonparam...">NGGPW</a>)  <br /></td></tr>
<tr class="separator:a8ec54ff9fe8f22c8514496d6f3b998d0 inherit pro_attribs_classSampler"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abec9d161c1e486904e6d2869890c4be3 inherit pro_attribs_classSampler" id="r_abec9d161c1e486904e6d2869890c4be3"><td class="memItemLeft" align="right" valign="top">std::random_device&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampler.html#abec9d161c1e486904e6d2869890c4be3">rd</a></td></tr>
<tr class="memdesc:abec9d161c1e486904e6d2869890c4be3 inherit pro_attribs_classSampler"><td class="mdescLeft">&#160;</td><td class="mdescRight">Random device for generating random numbers across sampling algorithms.  <br /></td></tr>
<tr class="separator:abec9d161c1e486904e6d2869890c4be3 inherit pro_attribs_classSampler"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Locality Sensitive Sampling (LSS) Split-Merge sampler for Bayesian nonparametric models. </p>
<p>This class implements the LSS Split-Merge algorithm, a variant of the split-merge sampler that uses locality sensitive sampling to select anchor points based on similarity information. LSS can be more efficient than standard split-merge for large datasets by focusing computational effort on similar observations.</p>
<p>Key differences from standard Split-Merge:</p><ul>
<li><b>Locality Sensitive Sampling</b>: Anchor points are selected based on similarity/distance</li>
<li><b>Sequential Allocation</b>: Observations are allocated one by one in random order</li>
<li><b>Efficient Computation</b>: Faster proposal generation leveraging data structure</li>
<li><b>Maintained Ergodicity</b>: Preserves theoretical properties of split-merge</li>
</ul>
<p>The algorithm maintains the same three types of moves (split, merge, shuffle) but uses locality sensitive sampling for anchor point selection and sequential allocation for generating proposals within each move type.</p>
<dl class="section note"><dt>Note</dt><dd>reference Luo, C., Shrivastava, A. (2018). "Scaling-up Split-Merge MCMC with
Locality Sensitive Sampling (LSS)" reference Dahl, D. B. and Newcomb, S. (2022). "Sequentially allocated merge-split samplers for conjugate Bayesian
nonparametric models" reference Martinez, A. F. and Mena, R. H. (2014). "On a
Nonparametric Change Point Detection Model in Markovian Regimes"</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="classSampler.html" title="Abstract base class for MCMC sampler implementations.">Sampler</a>, <a class="el" href="classSplitMerge.html" title="Split-Merge sampler for Bayesian nonparametric mixture models.">SplitMerge</a> </dd></dl>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a595c757322a9ad77de02a683f1617377" name="a595c757322a9ad77de02a683f1617377"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a595c757322a9ad77de02a683f1617377">&#9670;&#160;</a></span>SplitMerge_LSS()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">SplitMerge_LSS::SplitMerge_LSS </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classData.html">Data</a> &amp;&#160;</td>
          <td class="paramname"><em>d</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structParams.html">Params</a> &amp;&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classLikelihood.html">Likelihood</a> &amp;&#160;</td>
          <td class="paramname"><em>l</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classProcess.html">Process</a> &amp;&#160;</td>
          <td class="paramname"><em>pr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>shuffle</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Constructor for LSS (Locality Sensitive Sampling) Split-Merge sampler. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">d</td><td>Reference to <a class="el" href="classData.html" title="Manages distance matrices and cluster allocations for points.">Data</a> object containing observations </td></tr>
    <tr><td class="paramname">p</td><td>Reference to <a class="el" href="structParams.html" title="Structure containing all parameters needed for the NGGP (Normalized Generalized Gamma Process) and DP...">Params</a> object with hyperparameters </td></tr>
    <tr><td class="paramname">l</td><td>Reference to <a class="el" href="classLikelihood.html" title="Abstract class with likelihood desiderable interfaces.">Likelihood</a> object for probability computations </td></tr>
    <tr><td class="paramname">pr</td><td>Reference to <a class="el" href="classProcess.html" title="Abstract base class for Bayesian nonparametric processes.">Process</a> object defining the prior </td></tr>
    <tr><td class="paramname">shuffle</td><td>Flag to enable shuffle moves in addition to split-merge</td></tr>
  </table>
  </dd>
</dl>
<p>Initializes the LSS Split-Merge sampler, which uses locality sensitive sampling for anchor point selection and sequential allocation for generating proposals. This can provide computational advantages for large datasets. </p>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a9db1efefb6e1fd16e8be534c540178ba" name="a9db1efefb6e1fd16e8be534c540178ba"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9db1efefb6e1fd16e8be534c540178ba">&#9670;&#160;</a></span>choose_clusters_shuffle()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void SplitMerge_LSS::choose_clusters_shuffle </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Select clusters for shuffle move. </p>
<p>Determines cluster assignments and prepares for redistribution between two existing clusters. </p>
<p>Randomly choose two distinct clusters ci and cj from the current allocations. Update idx_i and idx_j to be random points from these clusters.</p>

</div>
</div>
<a id="a72d1782c9ef51178895107d575fc4171" name="a72d1782c9ef51178895107d575fc4171"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a72d1782c9ef51178895107d575fc4171">&#9670;&#160;</a></span>choose_indeces()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void SplitMerge_LSS::choose_indeces </td>
          <td>(</td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>similarity</em> = <code>false</code></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Randomly select two observations for split-merge proposal. </p>
<p>Uniformly samples two distinct observation indices that will determine the type of move and the clusters involved. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">similarity</td><td>If true, select indices from similar clusters </td></tr>
  </table>
  </dd>
</dl>
<p>Randomly choose two distinct indices i and j from the data points. Identify their clusters ci and cj. Prepare the launch_state and S vectors for the split-merge operation.</p>

</div>
</div>
<a id="a424feff7106b2f43492078d82cf1434f" name="a424feff7106b2f43492078d82cf1434f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a424feff7106b2f43492078d82cf1434f">&#9670;&#160;</a></span>compute_acceptance_ratio_merge()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double SplitMerge_LSS::compute_acceptance_ratio_merge </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>likelihood_old_ci</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>likelihood_old_cj</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Compute acceptance ratio for LSS merge move. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">likelihood_old_ci</td><td><a class="el" href="classLikelihood.html" title="Abstract class with likelihood desiderable interfaces.">Likelihood</a> of first original cluster </td></tr>
    <tr><td class="paramname">likelihood_old_cj</td><td><a class="el" href="classLikelihood.html" title="Abstract class with likelihood desiderable interfaces.">Likelihood</a> of second original cluster </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Log acceptance ratio for the merge proposal </dd></dl>
<p>Compute the log acceptance ratio for a merge move. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">likelihood_old_ci</td><td>The log likelihood of cluster ci before the merge. </td></tr>
    <tr><td class="paramname">likelihood_old_cj</td><td>The log likelihood of cluster cj before the merge. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The log acceptance ratio for the merge move.</dd></dl>

</div>
</div>
<a id="a9305380b10376e14313f9f1d708329a2" name="a9305380b10376e14313f9f1d708329a2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9305380b10376e14313f9f1d708329a2">&#9670;&#160;</a></span>compute_acceptance_ratio_shuffle()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double SplitMerge_LSS::compute_acceptance_ratio_shuffle </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>likelihood_old_ci</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>likelihood_old_cj</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>old_ci_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>old_cj_size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Compute acceptance ratio for LSS shuffle move. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">likelihood_old_ci</td><td><a class="el" href="classLikelihood.html" title="Abstract class with likelihood desiderable interfaces.">Likelihood</a> of first cluster before shuffle </td></tr>
    <tr><td class="paramname">likelihood_old_cj</td><td><a class="el" href="classLikelihood.html" title="Abstract class with likelihood desiderable interfaces.">Likelihood</a> of second cluster before shuffle </td></tr>
    <tr><td class="paramname">old_ci_size</td><td>Size of first cluster before shuffle </td></tr>
    <tr><td class="paramname">old_cj_size</td><td>Size of second cluster before shuffle </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Log acceptance ratio for the shuffle proposal </dd></dl>
<p>Compute the log acceptance ratio for a shuffle move. </p><dl class="section return"><dt>Returns</dt><dd>The log acceptance ratio for the shuffle move.</dd></dl>

</div>
</div>
<a id="a4feef4466a3f38f2514e757dd549c01f" name="a4feef4466a3f38f2514e757dd549c01f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4feef4466a3f38f2514e757dd549c01f">&#9670;&#160;</a></span>compute_acceptance_ratio_split()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double SplitMerge_LSS::compute_acceptance_ratio_split </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>likelihood_old_cluster</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Compute acceptance ratio for LSS split move. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">likelihood_old_cluster</td><td><a class="el" href="classLikelihood.html" title="Abstract class with likelihood desiderable interfaces.">Likelihood</a> of the original single cluster </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Log acceptance ratio for the split proposal </dd></dl>
<p>Compute the log acceptance ratio for a split move. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">likelihood_old_cluster</td><td>The log likelihood of the original cluster before the split. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The log acceptance ratio for the split move.</dd></dl>

</div>
</div>
<a id="aa8a4414bb201370286b0dbad7e73ea68" name="aa8a4414bb201370286b0dbad7e73ea68"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa8a4414bb201370286b0dbad7e73ea68">&#9670;&#160;</a></span>get_accepted_merge()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int SplitMerge_LSS::get_accepted_merge </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get number of accepted merge moves for diagnostics. </p>
<dl class="section return"><dt>Returns</dt><dd>Count of accepted merge moves </dd></dl>

</div>
</div>
<a id="ac4549dbcb5b175229392e7aab4ed694d" name="ac4549dbcb5b175229392e7aab4ed694d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac4549dbcb5b175229392e7aab4ed694d">&#9670;&#160;</a></span>get_accepted_shuffle()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int SplitMerge_LSS::get_accepted_shuffle </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get number of accepted shuffle moves for diagnostics. </p>
<dl class="section return"><dt>Returns</dt><dd>Count of accepted shuffle moves </dd></dl>

</div>
</div>
<a id="a1375b8d9efe2e2120592436e36bbba04" name="a1375b8d9efe2e2120592436e36bbba04"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1375b8d9efe2e2120592436e36bbba04">&#9670;&#160;</a></span>get_accepted_split()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int SplitMerge_LSS::get_accepted_split </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get number of accepted split moves for diagnostics. </p>
<dl class="section return"><dt>Returns</dt><dd>Count of accepted split moves </dd></dl>

</div>
</div>
<a id="a592b28bad845e868b2baef627472a8c3" name="a592b28bad845e868b2baef627472a8c3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a592b28bad845e868b2baef627472a8c3">&#9670;&#160;</a></span>merge_move()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void SplitMerge_LSS::merge_move </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Execute a merge move using LSS. </p>
<p>Attempts to merge two clusters into one using sequential allocation to determine the final unified assignment. </p>
<p>Propose a merge move by combining clusters ci and cj. Compute the acceptance ratio and decide whether to accept or reject the move.</p>

</div>
</div>
<a id="ac5252791b0a9a1a9b174421205a33c7d" name="ac5252791b0a9a1a9b174421205a33c7d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac5252791b0a9a1a9b174421205a33c7d">&#9670;&#160;</a></span>sequential_allocation()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void SplitMerge_LSS::sequential_allocation </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>iterations</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>only_probabilities</em> = <code>false</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>sequential</em> = <code>true</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Generate proposal state via sequential allocation. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">iterations</td><td>Number of allocation passes to perform </td></tr>
    <tr><td class="paramname">only_probabilities</td><td>If true, only compute proposal probabilities without updating state </td></tr>
    <tr><td class="paramname">sequential</td><td>If true, use sequential allocation; if false, use restricted Gibbs sampling</td></tr>
  </table>
  </dd>
</dl>
<p>Implements the core SAMS algorithm by sequentially allocating observations to clusters. Unlike restricted Gibbs sampling, this approach processes observations one by one in random order, making allocation decisions based on current partial assignments. </p>
<p>Perform restricted Gibbs sampling on the points in S to propose new allocations for iter iterations. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">iterations</td><td>Number of Gibbs sampling iterations to perform. </td></tr>
    <tr><td class="paramname">only_probabilities</td><td>If true, only compute the probabilities without </td></tr>
    <tr><td class="paramname">sequential</td><td>If true, unallocate points before sampling (default true) changing allocations (used in merge move).</td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="aec5dd1754aebe6d9898f31b8f51eade3" name="aec5dd1754aebe6d9898f31b8f51eade3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aec5dd1754aebe6d9898f31b8f51eade3">&#9670;&#160;</a></span>shuffle()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void SplitMerge_LSS::shuffle </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Execute a shuffle move using LSS. </p>
<p>Redistributes observations between two clusters using sequential allocation while maintaining the two-cluster structure. </p>
<p>Perform a shuffle move to refine the allocations of points in S. This move helps to improve mixing by allowing points to switch clusters.</p>

</div>
</div>
<a id="a6aed8447d79a5834366538cfe55371f4" name="a6aed8447d79a5834366538cfe55371f4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6aed8447d79a5834366538cfe55371f4">&#9670;&#160;</a></span>split_move()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void SplitMerge_LSS::split_move </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Execute a split move using LSS. </p>
<p>Attempts to split a cluster using sequential allocation to generate the proposal state. The two anchor observations are placed in separate subclusters initially. </p>
<p>Propose a split move by dividing cluster ci into two clusters. Compute the acceptance ratio and decide whether to accept or reject the move.</p>

</div>
</div>
<a id="a766bfa11be282aeb39428556c65e0296" name="a766bfa11be282aeb39428556c65e0296"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a766bfa11be282aeb39428556c65e0296">&#9670;&#160;</a></span>step()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void SplitMerge_LSS::step </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Perform one iteration of the LSS Split-Merge algorithm. </p>
<p>Executes one step of the LSS Split-Merge sampler:</p><ol type="1">
<li>Select two observations as anchors using locality sensitive sampling</li>
<li>Determine move type based on their current assignments</li>
<li>Generate proposal using sequential allocation</li>
<li>Compute acceptance ratio and accept/reject the proposal</li>
</ol>
<p>The locality sensitive sampling approach selects similar or dissimilar points based on distance information, while sequential allocation provides efficient proposal generation maintaining the theoretical properties of split-merge. </p>
<p>Perform a single split-merge MCMC step. Randomly choose two indices and decide whether to propose a split or merge move.</p>

<p>Implements <a class="el" href="classSampler.html#a49153313f42d53d107bfe2b2e9d83fa5">Sampler</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="a686d52f723a414c87007d64e647df358" name="a686d52f723a414c87007d64e647df358"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a686d52f723a414c87007d64e647df358">&#9670;&#160;</a></span>accepted_merge</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int SplitMerge_LSS::accepted_merge = 0</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a8697a2a479ff23e3ea6ac59758a26396" name="a8697a2a479ff23e3ea6ac59758a26396"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8697a2a479ff23e3ea6ac59758a26396">&#9670;&#160;</a></span>accepted_shuffle</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int SplitMerge_LSS::accepted_shuffle = 0</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a334e39e5d45c07d7ab1206ea42400af5" name="a334e39e5d45c07d7ab1206ea42400af5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a334e39e5d45c07d7ab1206ea42400af5">&#9670;&#160;</a></span>accepted_split</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int SplitMerge_LSS::accepted_split = 0</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="afb31363a48582dbf41b5d1749623d7df" name="afb31363a48582dbf41b5d1749623d7df"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afb31363a48582dbf41b5d1749623d7df">&#9670;&#160;</a></span>ci</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int SplitMerge_LSS::ci</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Cluster assignment of first observation. </p>

</div>
</div>
<a id="a6ced96fbbfdd52d9b0ae8682b83e5640" name="a6ced96fbbfdd52d9b0ae8682b83e5640"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6ced96fbbfdd52d9b0ae8682b83e5640">&#9670;&#160;</a></span>cj</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int SplitMerge_LSS::cj</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Cluster assignment of second observation. </p>

</div>
</div>
<a id="a99554021bcc51e39bc61dde55c7961b8" name="a99554021bcc51e39bc61dde55c7961b8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a99554021bcc51e39bc61dde55c7961b8">&#9670;&#160;</a></span>gen</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::mt19937 SplitMerge_LSS::gen</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">mutable</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Mersenne Twister random number generator for sampling operations. </p>

</div>
</div>
<a id="ac7a1b9806e8f045ca1b3e3c4f282c233" name="ac7a1b9806e8f045ca1b3e3c4f282c233"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac7a1b9806e8f045ca1b3e3c4f282c233">&#9670;&#160;</a></span>idx_i</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int SplitMerge_LSS::idx_i</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Index of first randomly chosen observation. </p>

</div>
</div>
<a id="a8c98c80c273d7bb82e5e17207dcbb90d" name="a8c98c80c273d7bb82e5e17207dcbb90d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8c98c80c273d7bb82e5e17207dcbb90d">&#9670;&#160;</a></span>idx_j</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int SplitMerge_LSS::idx_j</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Index of second randomly chosen observation. </p>

</div>
</div>
<a id="a5d32095728297ce218120e1bf6454cee" name="a5d32095728297ce218120e1bf6454cee"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5d32095728297ce218120e1bf6454cee">&#9670;&#160;</a></span>launch_state</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">Eigen::VectorXi SplitMerge_LSS::launch_state</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Launch state for sequential allocation. </p>

</div>
</div>
<a id="a16f2309b47927932ba6ec41a64665bd9" name="a16f2309b47927932ba6ec41a64665bd9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a16f2309b47927932ba6ec41a64665bd9">&#9670;&#160;</a></span>log_merge_gibbs_prob</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double SplitMerge_LSS::log_merge_gibbs_prob = 0</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Log probability of generating current state via sequential allocation (merge direction) </p>

</div>
</div>
<a id="ace64a91822dea799445ec13c33d54e3c" name="ace64a91822dea799445ec13c33d54e3c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ace64a91822dea799445ec13c33d54e3c">&#9670;&#160;</a></span>log_split_gibbs_prob</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double SplitMerge_LSS::log_split_gibbs_prob = 0</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Log probability of generating current state via sequential allocation (split direction) </p>

</div>
</div>
<a id="a8469a38fe1119d98269a4373cc3d2063" name="a8469a38fe1119d98269a4373cc3d2063"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8469a38fe1119d98269a4373cc3d2063">&#9670;&#160;</a></span>original_allocations</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">Eigen::VectorXi SplitMerge_LSS::original_allocations</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Original cluster assignments before move proposal. </p>

</div>
</div>
<a id="a339dbb5c0d5dcce9cf351c0dc34a29db" name="a339dbb5c0d5dcce9cf351c0dc34a29db"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a339dbb5c0d5dcce9cf351c0dc34a29db">&#9670;&#160;</a></span>S</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">Eigen::VectorXi SplitMerge_LSS::S</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Indices of observations in clusters ci and cj. </p>

</div>
</div>
<a id="afa850a59ac5189d46ea4f34babcb41e0" name="afa850a59ac5189d46ea4f34babcb41e0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afa850a59ac5189d46ea4f34babcb41e0">&#9670;&#160;</a></span>shuffle_bool</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool SplitMerge_LSS::shuffle_bool = false</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Flag to enable shuffle moves (Mena and Martinez, 2014) </p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>src/samplers/<a class="el" href="splitmerge__LSS_8hpp_source.html">splitmerge_LSS.hpp</a></li>
<li>src/samplers/<a class="el" href="splitmerge__LSS_8cpp.html">splitmerge_LSS.cpp</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.13.2-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="classSplitMerge__LSS.html">SplitMerge_LSS</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8 </li>
  </ul>
</div>
<script type="text/javascript" src="doxygen-awesome-darkmode-toggle.js"></script>
<script type="text/javascript">
    DoxygenAwesomeDarkModeToggle.init()
</script>
</body>
</html>
