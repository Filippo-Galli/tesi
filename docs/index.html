<!-- HTML header for doxygen 1.13.2-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.13.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Docs: Bayesian Nonparametric Clustering with MCMC</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="https://cdn.jsdelivr.net/gh/jothepro/doxygen-awesome-css@v2.3.4/doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="https://cdn.jsdelivr.net/gh/jothepro/doxygen-awesome-css@v2.3.4/doxygen-awesome-sidebar-only.css" rel="stylesheet" type="text/css"/>
<link href="https://cdn.jsdelivr.net/gh/jothepro/doxygen-awesome-css@v2.3.4/doxygen-awesome-sidebar-only-darkmode-toggle.css" rel="stylesheet" type="text/css"/>
<link href="custom.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Docs
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.13.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('index.html',''); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">Bayesian Nonparametric Clustering with MCMC </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="md_README"></a></p>
<p>A powerful framework for discovering clusters in your data without specifying the number of clusters in advance. This project combines the flexibility of Bayesian statistics with the efficiency of modern computational methods.</p>
<p><b>ğŸ“š Full Documentation:</b> <a href="https://filippo-galli.github.io/tesi/">API Reference &amp; Technical Details</a> <br  />
 <b>ğŸ¯ What it does:</b> Automatically finds natural groupings in complex datasets <br  />
 <b>âš¡ How it works:</b> R for easy analysis + C++ for fast computation </p>
<h1><a class="anchor" id="autotoc_md1"></a>
âœ¨ What Makes This Special?</h1>
<h2><a class="anchor" id="autotoc_md2"></a>
ğŸ¯ <b>Smart Clustering Methods</b></h2>
<p>You don't need to guess how many clusters exist in your data. The framework includes:</p><ul>
<li><b>Basic Models (<a class="el" href="classDP.html" title="Dirichlet Process class for Bayesian nonparametric clustering.">DP</a>)</b>: Great for getting started with automatic clustering</li>
<li><b>Flexible Models (<a class="el" href="classNGGP.html" title="Normalized Generalized Gamma Process class for Bayesian nonparametric clustering.">NGGP</a>)</b>: For complex data with varying cluster shapes and sizes</li>
<li><b>Spatial Models (<a class="el" href="classDPW.html" title="Dirichlet Process with spatial Weights class for spatially-aware Bayesian nonparametric clustering.">DPW</a>, <a class="el" href="classNGGPW.html" title="Normalized Generalized Gamma Process with spatial Weights class for spatially-aware Bayesian nonparam...">NGGPW</a>)</b>: When your data points have locations or network connections</li>
<li><b>Auto-tuning</b>: The system helps estimate good starting parameters</li>
</ul>
<p>ï¿½ <em><a href="https://filippo-galli.github.io/tesi/">See technical details in documentation</a></em></p>
<h2><a class="anchor" id="autotoc_md3"></a>
ğŸ”„ <b>Multiple Analysis Methods</b></h2>
<p>Different algorithms for different needs:</p><ul>
<li><b>Fast &amp; Simple</b>: Neal's algorithm for quick results on well-separated clusters</li>
<li><b>Robust</b>: Split-Merge methods for tricky clustering problems</li>
<li><b>Optimized</b>: SAMS variant for large datasets</li>
</ul>
<p>ğŸ‘‰ <em><a href="https://filippo-galli.github.io/tesi/">Algorithm comparison in docs</a></em></p>
<h2><a class="anchor" id="autotoc_md4"></a>
ğŸŒ <b>Location-Aware Clustering</b></h2>
<p>Perfect for geographic data or networks:</p><ul>
<li>Automatically consider nearby points when forming clusters</li>
<li>Works with any adjacency structure (neighbors, social networks, etc.)</li>
<li>Adjustable spatial influence</li>
</ul>
<h2><a class="anchor" id="autotoc_md5"></a>
ğŸ“Š <b>Rich Visualization &amp; Diagnostics</b></h2>
<p>Understand your results with:</p><ul>
<li>Real-time progress monitoring</li>
<li>Professional plots and heatmaps</li>
<li>Quality metrics (how well did it work?)</li>
<li>Reproducible analysis scripts</li>
</ul>
<h1><a class="anchor" id="autotoc_md6"></a>
ğŸ“ Project Architecture</h1>
<div class="fragment"><div class="line">tesi/</div>
<div class="line">â”œâ”€â”€ ğŸ“‚ R/                                      # R Analysis &amp; Visualization Suite</div>
<div class="line">â”‚   â”œâ”€â”€ ğŸ”¬ sim_data_production.R                  # Data simulation (Natarajan/Gaussian/Gamma)</div>
<div class="line">â”‚   â”œâ”€â”€ ğŸš€ simulation_data.R                      # Main MCMC workflow orchestration  </div>
<div class="line">â”‚   â”œâ”€â”€ ğŸ“Š analysis.R                             # Post-processing and visualization</div>
<div class="line">â”‚   â”œâ”€â”€ ğŸ› ï¸  utils.R                               # Utility functions and diagnostics</div>
<div class="line">â”‚   â”œâ”€â”€ ï¿½ Likelihood_params_analisys.R           # Hyperparameter analysis tools</div>
<div class="line">â”‚   â””â”€â”€ ğŸ§ª U_cond_density.R                       # NGGP U-parameter density analysis</div>
<div class="line">â”œâ”€â”€ ï¿½ğŸ“‚ src/                                    # High-Performance C++ Core</div>
<div class="line">â”‚   â”œâ”€â”€ ğŸ“‚ utils/                                  # Core Framework Components</div>
<div class="line">â”‚   â”‚   â”œâ”€â”€ Sampler.hpp                              # Abstract MCMC sampler base class</div>
<div class="line">â”‚   â”‚   â”œâ”€â”€ Process.hpp                              # Bayesian nonparametric process interface  </div>
<div class="line">â”‚   â”‚   â”œâ”€â”€ Data.hpp/.cpp                            # Efficient cluster data management</div>
<div class="line">â”‚   â”‚   â”œâ”€â”€ Likelihood.hpp/.cpp                      # Optimized likelihood computations</div>
<div class="line">â”‚   â”‚   â””â”€â”€ Params.hpp                               # Comprehensive parameter management</div>
<div class="line">â”‚   â”œâ”€â”€ ï¿½ samplers/                               # MCMC Sampling Algorithms</div>
<div class="line">â”‚   â”‚   â”œâ”€â”€ neal.hpp/.cpp                            # Neal&#39;s Algorithm 3 (collapsed Gibbs)</div>
<div class="line">â”‚   â”‚   â”œâ”€â”€ neal_ZDNAM.hpp/.cpp                      # ZDNAM-enhanced Neal sampler</div>
<div class="line">â”‚   â”‚   â”œâ”€â”€ splitmerge.hpp/.cpp                      # Split-Merge sampler  </div>
<div class="line">â”‚   â”‚   â”œâ”€â”€ splitmerge_SAMS.hpp/.cpp                 # Sequential Allocation Merge-Split</div>
<div class="line">â”‚   â”‚   â””â”€â”€ ï¿½ U_sampler/                            # Continuous Parameter Samplers</div>
<div class="line">â”‚   â”‚       â”œâ”€â”€ RWMH.hpp                                 # Random Walk Metropolis-Hastings</div>
<div class="line">â”‚   â”‚       â””â”€â”€ MALA.hpp                                 # Metropolis-Adjusted Langevin</div>
<div class="line">â”‚   â”œâ”€â”€ ğŸ“‚ processes/                              # Bayesian Nonparametric Processes</div>
<div class="line">â”‚   â”‚   â”œâ”€â”€ DP.hpp/.cpp                              # Dirichlet Process</div>
<div class="line">â”‚   â”‚   â”œâ”€â”€ DPW.hpp/.cpp                             # Weighted Dirichlet Process (spatial)</div>
<div class="line">â”‚   â”‚   â”œâ”€â”€ NGGP.hpp/.cpp                            # Normalized Generalized Gamma Process</div>
<div class="line">â”‚   â”‚   â””â”€â”€ NGGPW.hpp/.cpp                           # Weighted NGGP (spatial)</div>
<div class="line">â”‚   â””â”€â”€ ğŸ”— launcher.cpp                           # R-C++ integration interface</div>
<div class="line">â”œâ”€â”€ ğŸ“‚ docs/                                   # Auto-Generated Documentation</div>
<div class="line">â”‚   â”œâ”€â”€ ğŸ“– HTML files                              # Doxygen API reference</div>
<div class="line">â”‚   â””â”€â”€ ğŸ¨ Custom CSS                              # Documentation styling</div>
<div class="line">â”œâ”€â”€ ğŸ“‚ doxygen-theme/                          # Doxygen Theme Components</div>
<div class="line">â”œâ”€â”€ ğŸ“‚ simulation_data/                        # Simulated Datasets Repository</div>
<div class="line">â”‚   â””â”€â”€ ğŸ“Š Natarajan_{Ïƒ}sigma_{d}d/              # Organized by parameters</div>
<div class="line">â”‚       â”œâ”€â”€ all_data.rds                             # Raw data points</div>
<div class="line">â”‚       â”œâ”€â”€ ground_truth.rds                         # True cluster labels</div>
<div class="line">â”‚       â””â”€â”€ dist_matrix.rds                          # Distance matrix</div>
<div class="line">â”œâ”€â”€ ğŸ“‚ results/                                # MCMC Analysis Outputs  </div>
<div class="line">â”‚   â””â”€â”€ ğŸ“ˆ {process}_{sampler}_{init}_{params}/  # Results by configuration</div>
<div class="line">â”‚       â”œâ”€â”€ simulation_results.rds                   # MCMC output</div>
<div class="line">â”‚       â”œâ”€â”€ simulation_ground_truth.rds              # True labels</div>
<div class="line">â”‚       â”œâ”€â”€ simulation_data.rds                      # Original data</div>
<div class="line">â”‚       â”œâ”€â”€ simulation_distance_matrix.rds           # Distance matrix</div>
<div class="line">â”‚       â”œâ”€â”€ simulation_initial_params.rds            # Parameter object</div>
<div class="line">â”‚       â””â”€â”€ plots/                                   # Generated visualizations</div>
<div class="line">â”œâ”€â”€ âš™ï¸  devenv.nix                              # Reproducible Development Environment</div>
<div class="line">â”œâ”€â”€ ğŸ”§ devenv.yaml                             # Environment Configuration  </div>
<div class="line">â”œâ”€â”€ ğŸ”’ devenv.lock                             # Locked Dependencies</div>
<div class="line">â”œâ”€â”€ ğŸ“‹ Doxyfile                                # Doxygen configuration</div>
<div class="line">â””â”€â”€ ğŸ“ README.MD                              # This comprehensive guide</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md7"></a>
ğŸš€ Quick Start</h1>
<h2><a class="anchor" id="autotoc_md8"></a>
Option 1: Automatic Setup (Recommended)</h2>
<p>The easiest way using <a href="https://devenv.sh/">devenv</a> - it handles everything automatically:</p>
<ol type="1">
<li><b>Install Nix</b> (one-time setup): <div class="fragment"><div class="line">curl --proto &#39;=https&#39; --tlsv1.2 -sSf -L https://install.determinate.systems/nix | sh -s -- install</div>
</div><!-- fragment --></li>
<li><b>Install devenv</b>: <div class="fragment"><div class="line">nix profile install --accept-flake-config github:cachix/devenv/latest</div>
</div><!-- fragment --></li>
<li><b>Start working</b> (from the project folder): <div class="fragment"><div class="line">cd /path/to/tesi</div>
<div class="line">devenv shell</div>
</div><!-- fragment --></li>
</ol>
<p>That's it! Everything you need is now installed and ready.</p>
<h2><a class="anchor" id="autotoc_md9"></a>
Option 2: Manual Setup</h2>
<p>If you prefer to install components yourself:</p>
<p><b>In R:</b> </p><div class="fragment"><div class="line">install.packages(c(</div>
<div class="line">  <span class="stringliteral">&quot;Rcpp&quot;</span>, <span class="stringliteral">&quot;RcppEigen&quot;</span>, <span class="stringliteral">&quot;ggplot2&quot;</span>, <span class="stringliteral">&quot;dplyr&quot;</span>, </div>
<div class="line">  <span class="stringliteral">&quot;mcclust.ext&quot;</span>, <span class="stringliteral">&quot;salso&quot;</span>, <span class="stringliteral">&quot;MASS&quot;</span></div>
<div class="line">))</div>
</div><!-- fragment --><p><b>System requirements:</b></p><ul>
<li>R version 4.0 or newer</li>
<li>A C++ compiler</li>
<li>Eigen3 library (for linear algebra)</li>
</ul>
<p>Most of these are pre-installed on modern systems or easily available through your package manager.</p>
<h1><a class="anchor" id="autotoc_md10"></a>
ğŸ“– How to Use</h1>
<h2><a class="anchor" id="autotoc_md11"></a>
Step 1: Create Test Data</h2>
<p>Generate some clustering data to practice with:</p>
<div class="fragment"><div class="line">Rscript R/sim_data_production.R</div>
</div><!-- fragment --><p><b>What this does:</b></p><ul>
<li>Creates synthetic datasets with known cluster structures</li>
<li>Saves them in the <code>simulation_data/</code> folder</li>
<li>You can verify the clustering algorithms work correctly</li>
</ul>
<p><b>Customize your data</b> (open <code>R/sim_data_production.R</code> and edit): </p><div class="fragment"><div class="line">sigma &lt;- 0.25  <span class="comment"># How separated are clusters? (0.18=close, 0.25=far apart)</span></div>
<div class="line">d &lt;- 10        <span class="comment"># How many dimensions? (10 or 50)</span></div>
<div class="line">N &lt;- 100       <span class="comment"># How many data points?</span></div>
</div><!-- fragment --><p>The script supports different data types - see comments in the file for Gaussian or Gamma distributions.</p>
<h2><a class="anchor" id="autotoc_md12"></a>
Step 2: Run the Clustering Analysis</h2>
<p>Analyze your data to find clusters:</p>
<div class="fragment"><div class="line">Rscript R/simulation_data.R</div>
</div><!-- fragment --><p><b>What happens:</b></p><ol type="1">
<li>Loads your data</li>
<li>Makes smart guesses about initial parameters (using k-means)</li>
<li>Runs the clustering algorithm</li>
<li>Shows you progress in real-time</li>
<li>Saves results for later analysis</li>
</ol>
<p><b>Choosing Your Algorithm</b> (edit <code><a class="el" href="launcher_8cpp.html" title="Main launcher file for MCMC simulation with various Bayesian non-parametric processes.">src/launcher.cpp</a></code>):</p>
<p>The framework lets you mix and match different components. Here's what's currently active:</p>
<div class="fragment"><div class="line"><span class="comment">// Which clustering model? (uncomment one)</span></div>
<div class="line"><span class="comment">// DP process(data, param);              // Standard (simple, fast)</span></div>
<div class="line"><span class="comment">// DPW process(data, param);             // Standard + spatial awareness</span></div>
<div class="line"><span class="comment">// NGGP process(data, param);            // Flexible (handles complex shapes)</span></div>
<div class="line"><a class="code hl_class" href="classNGGPW.html">NGGPW</a> process(data, param);              <span class="comment">// Flexible + spatial âœ“ CURRENTLY USED</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">// Which sampling method? (uncomment one)</span></div>
<div class="line"><span class="comment">// Neal3 sampler(...);                   // Fast (good for simple cases)</span></div>
<div class="line"><span class="comment">// SplitMerge sampler(...);              // Robust (better for tricky data)</span></div>
<div class="line"><a class="code hl_class" href="classSplitMerge__SAMS.html">SplitMerge_SAMS</a> sampler(...);            <span class="comment">// Optimized (best for large data) âœ“ CURRENTLY USED</span></div>
<div class="ttc" id="aclassNGGPW_html"><div class="ttname"><a href="classNGGPW.html">NGGPW</a></div><div class="ttdoc">Normalized Generalized Gamma Process with spatial Weights class for spatially-aware Bayesian nonparam...</div><div class="ttdef"><b>Definition</b> NGGPW.hpp:23</div></div>
<div class="ttc" id="aclassSplitMerge__SAMS_html"><div class="ttname"><a href="classSplitMerge__SAMS.html">SplitMerge_SAMS</a></div><div class="ttdoc">Sequential Allocation Merge-Split (SAMS) sampler for Bayesian nonparametric models.</div><div class="ttdef"><b>Definition</b> splitmerge_SAMS.hpp:47</div></div>
</div><!-- fragment --><p><b>Tuning the Analysis</b> (in <code>R/simulation_data.R</code>):</p>
<p>Most parameters are set automatically, but you can adjust these:</p>
<div class="fragment"><div class="line">param &lt;- new(Params,</div>
<div class="line">  hyperparams$delta1, hyperparams$alpha, hyperparams$beta,  <span class="comment"># Auto-set âœ“</span></div>
<div class="line">  hyperparams$delta2, hyperparams$gamma, hyperparams$zeta,  <span class="comment"># Auto-set âœ“</span></div>
<div class="line">  </div>
<div class="line">  <span class="comment"># How long to run? (adjust these)</span></div>
<div class="line">  10000,        <span class="comment"># Burn-in: initial warm-up phase (larger = more reliable)</span></div>
<div class="line">  10000,        <span class="comment"># Sampling: how many samples to collect</span></div>
<div class="line">  </div>
<div class="line">  <span class="comment"># Clustering behavior (tune these if needed)</span></div>
<div class="line">  2,            <span class="comment"># How many clusters to expect? (higher = finds more clusters)</span></div>
<div class="line">  0.1,          <span class="comment"># Flexibility: how varied can cluster shapes be? (0.1 to 0.7)</span></div>
<div class="line">  1,            <span class="comment"># Advanced parameter (usually leave at 1)</span></div>
<div class="line">  </div>
<div class="line">  <span class="comment"># Spatial awareness (for geographic data)</span></div>
<div class="line">  1,            <span class="comment"># How much to consider location? (0 = ignore, 1+ = consider)</span></div>
<div class="line">  W             <span class="comment"># Which points are neighbors?</span></div>
<div class="line">)</div>
</div><!-- fragment --><p><b>Quick tuning guide:</b></p><ul>
<li><b>Finding too many clusters?</b> Reduce the "expect" parameter (try 1 or 0.5)</li>
<li><b>Finding too few?</b> Increase it (try 3 or 4)</li>
<li><b>Need better quality?</b> Increase both burn-in and sampling (try 20000 each)</li>
<li><b>Fast test run?</b> Use 2000 burn-in, 5000 sampling</li>
</ul>
<p>ğŸ‘‰ <em><a href="https://filippo-galli.github.io/tesi/classParams.html">Full parameter guide in documentation</a></em></p>
<h2><a class="anchor" id="autotoc_md13"></a>
Step 3: Visualize Results</h2>
<p>Create plots and check how well it worked:</p>
<div class="fragment"><div class="line">Rscript R/analysis.R</div>
</div><!-- fragment --><p><b>Point it to your results</b> (edit the folder path in the script): </p><div class="fragment"><div class="line">folder &lt;- <span class="stringliteral">&quot;results/NGGPW_Neal_kmeans_0.2sigma_50d_BI2000_NI5000_a0.1_sigma0.7_tau1/&quot;</span></div>
</div><!-- fragment --><p><b>You'll get:</b></p><ul>
<li><b>Quality checks</b>: Did the algorithm converge? Is it stable?</li>
<li><b>Cluster visualizations</b>: Heatmaps and plots showing the discovered clusters</li>
<li><b>Performance scores</b>: How well do the clusters match reality? (for test data)</li>
<li><b>Beautiful plots</b>: Publication-ready figures saved in the <code>plots/</code> folder</li>
</ul>
<p><b>Understanding the output:</b></p><ul>
<li>Stable horizontal lines in trace plots = good convergence âœ“</li>
<li>High ARI score (&gt;0.8) = excellent clustering âœ“</li>
<li>Clear blocks in heatmap = distinct clusters âœ“</li>
</ul>
<h1><a class="anchor" id="autotoc_md14"></a>
Output Files</h1>
<h2><a class="anchor" id="autotoc_md15"></a>
Generated Data (<code>simulation_data/</code>)</h2>
<div class="fragment"><div class="line">simulation_data/Natarajan_{Ïƒ}sigma_{d}d/</div>
<div class="line">â”œâ”€â”€ all_data.rds           # NÃ—d matrix of data points</div>
<div class="line">â”œâ”€â”€ ground_truth.rds       # True cluster labels (length N vector)</div>
<div class="line">â””â”€â”€ dist_matrix.rds        # NÃ—N distance matrix</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md16"></a>
MCMC Results (<code>results/</code>)</h2>
<p>Organized by configuration: <code>{process}_{sampler}_{init}_{params}/</code></p>
<p>Example: <code>NGGPW_Neal_kmeans_0.2sigma_50d_BI2000_NI5000_a0.1_sigma0.7_tau1/</code></p>
<div class="fragment"><div class="line">results/{configuration}/</div>
<div class="line">â”œâ”€â”€ simulation_results.rds              # Main MCMC output</div>
<div class="line">â”‚   â”œâ”€â”€ $allocations                       # List of cluster assignments per iteration</div>
<div class="line">â”‚   â”œâ”€â”€ $K                                 # Number of clusters per iteration  </div>
<div class="line">â”‚   â”œâ”€â”€ $loglikelihood                     # Log-likelihood trace</div>
<div class="line">â”‚   â””â”€â”€ $U                                 # NGGP U parameter trace (if applicable)</div>
<div class="line">â”œâ”€â”€ simulation_ground_truth.rds         # True labels (for validation)</div>
<div class="line">â”œâ”€â”€ simulation_data.rds                 # Original data matrix</div>
<div class="line">â”œâ”€â”€ simulation_distance_matrix.rds      # Distance matrix used</div>
<div class="line">â”œâ”€â”€ simulation_initial_params.rds       # Params object (hyperparameters)</div>
<div class="line">â””â”€â”€ plots/                              # Generated visualizations</div>
<div class="line">    â”œâ”€â”€ trace_plot_K.png</div>
<div class="line">    â”œâ”€â”€ trace_plot_loglikelihood.png</div>
<div class="line">    â”œâ”€â”€ posterior_similarity_matrix.png</div>
<div class="line">    â”œâ”€â”€ cluster_assignments.png</div>
<div class="line">    â”œâ”€â”€ distance_distribution.png</div>
<div class="line">    â””â”€â”€ ... (additional diagnostic plots)</div>
</div><!-- fragment --><p><b>Naming Convention:</b></p><ul>
<li><b><a class="el" href="classProcess.html" title="Abstract base class for Bayesian nonparametric processes.">Process</a></b>: <code><a class="el" href="classDP.html" title="Dirichlet Process class for Bayesian nonparametric clustering.">DP</a></code>, <code><a class="el" href="classDPW.html" title="Dirichlet Process with spatial Weights class for spatially-aware Bayesian nonparametric clustering.">DPW</a></code>, <code><a class="el" href="classNGGP.html" title="Normalized Generalized Gamma Process class for Bayesian nonparametric clustering.">NGGP</a></code>, <code><a class="el" href="classNGGPW.html" title="Normalized Generalized Gamma Process with spatial Weights class for spatially-aware Bayesian nonparam...">NGGPW</a></code></li>
<li><b><a class="el" href="classSampler.html" title="Abstract base class for MCMC sampler implementations.">Sampler</a></b>: <code>Neal</code>, <code>Neal_ZDNAM</code>, <code>SM</code> (<a class="el" href="classSplitMerge.html" title="Split-Merge sampler for Bayesian nonparametric mixture models.">SplitMerge</a>), <code>SAMS</code></li>
<li><b>Initialization</b>: <code>kmeans</code>, <code>sequential</code>, <code>single</code></li>
<li><b>Parameters</b>: <code>{Ïƒ}sigma_{d}d_BI{burn-in}_NI{iterations}_a{mass}_sigma{Ïƒ}_tau{Ï„}</code></li>
</ul>
<h1><a class="anchor" id="autotoc_md17"></a>
ğŸ”§ For Developers</h1>
<h2><a class="anchor" id="autotoc_md18"></a>
Main Functions You'll Use</h2>
<p><b>In R (<code>R/utils.R</code>):</b> </p><div class="fragment"><div class="line"><span class="comment"># Create test data</span></div>
<div class="line">generate_mixture_data(N = 100, sigma = 0.25, d = 10)</div>
<div class="line"> </div>
<div class="line"><span class="comment"># Set up parameters automatically</span></div>
<div class="line">set_hyperparameters(data, dist_matrix, k_elbow = 3)</div>
<div class="line"> </div>
<div class="line"><span class="comment"># Visualize results</span></div>
<div class="line">plot_mcmc_results(mcmc_result, ground_truth, BI = 2000)</div>
<div class="line"> </div>
<div class="line"><span class="comment"># Check if the right number of clusters is being found</span></div>
<div class="line">plot_k_means(dist_matrix, max_k = 15)</div>
</div><!-- fragment --><p><b>Main entry point (<code><a class="el" href="launcher_8cpp.html" title="Main launcher file for MCMC simulation with various Bayesian non-parametric processes.">src/launcher.cpp</a></code>):</b> </p><div class="fragment"><div class="line"><span class="comment">// The function that does all the clustering work</span></div>
<div class="line">Rcpp::List <a class="code hl_function" href="launcher_8cpp.html#a6272d2af196ebe5de74cf25bc8d1deb9">mcmc</a>(distances, param, initial_allocations)</div>
<div class="ttc" id="alauncher_8cpp_html_a6272d2af196ebe5de74cf25bc8d1deb9"><div class="ttname"><a href="launcher_8cpp.html#a6272d2af196ebe5de74cf25bc8d1deb9">mcmc</a></div><div class="ttdeci">Rcpp::List mcmc(Params &amp;param, const Rcpp::IntegerVector &amp;initial_allocations_r=Rcpp::IntegerVector())</div><div class="ttdoc">Main MCMC function for Bayesian non-parametric clustering.</div><div class="ttdef"><b>Definition</b> launcher.cpp:102</div></div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md19"></a>
Architecture Overview</h2>
<p>The code is organized in layers:</p>
<div class="fragment"><div class="line">R Scripts (Easy to use)</div>
<div class="line">    â†“</div>
<div class="line">launcher.cpp (Connects R to C++)</div>
<div class="line">    â†“</div>
<div class="line">Processes (DP, NGGP, etc.) â† What kind of clustering?</div>
<div class="line">    â†“</div>
<div class="line">Samplers (Neal, SplitMerge, etc.) â† How to find clusters?</div>
<div class="line">    â†“</div>
<div class="line">Data &amp; Likelihood (Math happens here)</div>
</div><!-- fragment --> <h1><a class="anchor" id="autotoc_md20"></a>
ğŸ’¡ Example Workflow</h1>
<h2><a class="anchor" id="autotoc_md21"></a>
Your First Analysis (Step by Step)</h2>
<p><b>1. Make some test data:</b> </p><div class="fragment"><div class="line"><span class="comment"># Open R and run:</span></div>
<div class="line">source(<span class="stringliteral">&quot;R/utils.R&quot;</span>)</div>
<div class="line">set.seed(123)</div>
<div class="line"> </div>
<div class="line"><span class="comment"># Create 2 clear clusters</span></div>
<div class="line">library(MASS)</div>
<div class="line">cluster1 &lt;- mvrnorm(30, mu = c(0, 0), Sigma = diag(2))</div>
<div class="line">cluster2 &lt;- mvrnorm(30, mu = c(5, 5), Sigma = diag(2))</div>
<div class="line">my_data &lt;- rbind(cluster1, cluster2)</div>
<div class="line"> </div>
<div class="line"><span class="comment"># Save it</span></div>
<div class="line">saveRDS(my_data, <span class="stringliteral">&quot;my_test_data.rds&quot;</span>)</div>
</div><!-- fragment --><p><b>2. Run clustering:</b> </p><div class="fragment"><div class="line"><span class="comment"># Load the framework</span></div>
<div class="line">source(<span class="stringliteral">&quot;R/utils.R&quot;</span>)</div>
<div class="line">sourceCpp(<span class="stringliteral">&quot;src/launcher.cpp&quot;</span>)</div>
<div class="line"> </div>
<div class="line"><span class="comment"># Load your data</span></div>
<div class="line">my_data &lt;- readRDS(<span class="stringliteral">&quot;my_test_data.rds&quot;</span>)</div>
<div class="line">dist_matrix &lt;- as.matrix(dist(my_data))</div>
<div class="line"> </div>
<div class="line"><span class="comment"># Let it figure out good parameters</span></div>
<div class="line">W &lt;- retrieve_W(dist_matrix, k = 5)</div>
<div class="line">hyperparams &lt;- set_hyperparameters(my_data, dist_matrix, k_elbow = 2)</div>
<div class="line"> </div>
<div class="line"><span class="comment"># Set up the analysis (using defaults)</span></div>
<div class="line">param &lt;- new(Params,</div>
<div class="line">  hyperparams$delta1, hyperparams$alpha, hyperparams$beta,</div>
<div class="line">  hyperparams$delta2, hyperparams$gamma, hyperparams$zeta,</div>
<div class="line">  2000, 5000,    <span class="comment"># Burn-in: 2000, Sampling: 5000</span></div>
<div class="line">  1, 0.5, 1,     <span class="comment"># Expect ~2 clusters, moderate flexibility</span></div>
<div class="line">  0, W           <span class="comment"># No spatial (our data isn&#39;t geographic)</span></div>
<div class="line">)</div>
<div class="line"> </div>
<div class="line"><span class="comment"># Run it!</span></div>
<div class="line">result &lt;- <a class="code hl_function" href="launcher_8cpp.html#a6272d2af196ebe5de74cf25bc8d1deb9">mcmc</a>(dist_matrix, param, hyperparams$initial_clusters - 1)</div>
</div><!-- fragment --><p><b>3. See what you found:</b> </p><div class="fragment"><div class="line"><span class="comment"># Make plots</span></div>
<div class="line">plot_mcmc_results(result, BI = 2000)</div>
<div class="line"> </div>
<div class="line"><span class="comment"># How many clusters did it find?</span></div>
<div class="line">final_K &lt;- result$K[2001:length(result$K)]  <span class="comment"># After burn-in</span></div>
<div class="line">mean(final_K)  <span class="comment"># Should be close to 2</span></div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md22"></a>
Working with the Example Data</h2>
<p>The project includes pre-made examples:</p>
<div class="fragment"><div class="line"># Generate example datasets</div>
<div class="line">Rscript R/sim_data_production.R</div>
<div class="line"> </div>
<div class="line"># Run analysis on them</div>
<div class="line">Rscript R/simulation_data.R</div>
<div class="line"> </div>
<div class="line"># Make plots</div>
<div class="line">Rscript R/analysis.R</div>
</div><!-- fragment --><p>Each script is well-commented - open them to see exactly what's happening!</p>
<h1><a class="anchor" id="autotoc_md23"></a>
âš™ï¸ Advanced Options</h1>
<h2><a class="anchor" id="autotoc_md24"></a>
Switching Algorithms</h2>
<p>The default setup works well for most cases, but you can customize:</p>
<p><b>In <code><a class="el" href="launcher_8cpp.html" title="Main launcher file for MCMC simulation with various Bayesian non-parametric processes.">src/launcher.cpp</a></code>, find these lines and uncomment what you want:</b></p>
<div class="fragment"><div class="line"><span class="comment">// Line ~110: Pick your clustering model</span></div>
<div class="line"><a class="code hl_class" href="classNGGPW.html">NGGPW</a> process(data, params, likelihood);  <span class="comment">// Current choice</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">// Line ~125: Pick your sampling method  </span></div>
<div class="line"><a class="code hl_class" href="classSplitMerge__SAMS.html">SplitMerge_SAMS</a> sampler(...);  <span class="comment">// Current choice</span></div>
</div><!-- fragment --><p>After changing, recompile in R: </p><div class="fragment"><div class="line">sourceCpp(<span class="stringliteral">&quot;src/launcher.cpp&quot;</span>)</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md25"></a>
Spatial/Geographic Data</h2>
<p>If your data has locations or network structure:</p>
<div class="fragment"><div class="line"><span class="comment"># Create neighbor connections (5 nearest neighbors)</span></div>
<div class="line">W &lt;- retrieve_W(dist_matrix, k = 5)</div>
<div class="line"> </div>
<div class="line"><span class="comment"># Or use your own adjacency matrix</span></div>
<div class="line"><span class="comment"># W &lt;- my_neighbor_matrix  # 1 if neighbors, 0 otherwise</span></div>
<div class="line"> </div>
<div class="line"><span class="comment"># Tell the model to use spatial info</span></div>
<div class="line">param &lt;- new(Params, ...,</div>
<div class="line">  coefficient = 1,  <span class="comment"># How much to consider location (0 to 2)</span></div>
<div class="line">  W                 <span class="comment"># Your neighbor matrix</span></div>
<div class="line">)</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md26"></a>
ğŸ“š References &amp; Citations</h1>
<ul>
<li><b>Neal, R. M. (2000)</b>: "Markov Chain Sampling Methods for Dirichlet Process Mixture Models"</li>
<li><b>Jain, S. &amp; Neal, R. M. (2004)</b>: "A Split-Merge Markov Chain Monte Carlo Procedure for the Dirichlet Process Mixture Model" <br  />
</li>
<li><b>Dahl, D. B. and Newcomb, S. (2022)</b>: "Sequentially allocated merge-split samplers for conjugate Bayesian nonparametric models"</li>
<li><b>Favaro, S. &amp; Teh, Y. W. (2013)</b>: "MCMC for Normalized Random Measure Mixture Models"</li>
<li><b>Martinez, A. F. and Mena, R. H. (2014)</b>: "On a Nonparametric Change Point Detection Model in Markovian Regimes"</li>
<li><b>Natarajan, A. and De Iorio, M. (2023)</b>: "Cohesion and Repulsion in Bayesian Distance Clustering" </li>
</ul>
</div></div><!-- PageDoc -->
<a href="doxygen_crawl.html"></a>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.13.2-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.13.2 </li>
  </ul>
</div>
<script type="text/javascript" src="doxygen-awesome-darkmode-toggle.js"></script>
<script type="text/javascript">
    DoxygenAwesomeDarkModeToggle.init()
</script>
</body>
</html>
