<!-- HTML header for doxygen 1.13.2-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.13.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Docs: SpatialModule Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="https://cdn.jsdelivr.net/gh/jothepro/doxygen-awesome-css@v2.3.4/doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="https://cdn.jsdelivr.net/gh/jothepro/doxygen-awesome-css@v2.3.4/doxygen-awesome-sidebar-only.css" rel="stylesheet" type="text/css"/>
<link href="https://cdn.jsdelivr.net/gh/jothepro/doxygen-awesome-css@v2.3.4/doxygen-awesome-sidebar-only-darkmode-toggle.css" rel="stylesheet" type="text/css"/>
<link href="custom.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Docs
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.13.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('classSpatialModule.html',''); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pro-methods">Protected Member Functions</a> &#124;
<a href="#pro-attribs">Protected Attributes</a> &#124;
<a href="classSpatialModule-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">SpatialModule Class Reference</div></div>
</div><!--header-->
<div class="contents">

<p><a class="el" href="classModule.html" title="Abstract base class for modules used in clustering processes. This class defines the interface for mo...">Module</a> providing spatial methods for processes utilizing spatial information.  
 <a href="#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="spatial__module_8hpp_source.html">spatial_module.hpp</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for SpatialModule:</div>
<div class="dyncontent">
 <div class="center">
  <img src="classSpatialModule.png" usemap="#SpatialModule_map" alt=""/>
  <map id="SpatialModule_map" name="SpatialModule_map">
<area href="classModule.html" title="Abstract base class for modules used in clustering processes. This class defines the interface for mo..." alt="Module" shape="rect" coords="0,0,92,24"/>
  </map>
</div></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a239a34ffe181cd9434d5087b821d4b4d" id="r_a239a34ffe181cd9434d5087b821d4b4d"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a239a34ffe181cd9434d5087b821d4b4d">SpatialModule</a> (const <a class="el" href="classData.html">Data</a> &amp;data_, const Eigen::MatrixXi W_, double spatial_coeff, const Eigen::VectorXi *old_alloc_provider=nullptr, const std::unordered_map&lt; int, std::vector&lt; int &gt; &gt; *old_cluster_members_provider_=nullptr)</td></tr>
<tr class="memdesc:a239a34ffe181cd9434d5087b821d4b4d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructs a <a class="el" href="classSpatialModule.html" title="Module providing spatial methods for processes utilizing spatial information.">SpatialModule</a> with parameter and data references.  <br /></td></tr>
<tr class="separator:a239a34ffe181cd9434d5087b821d4b4d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr><td colspan="2"><div class="groupHeader">Spatial Methods</div></td></tr>
<tr class="memitem:ab9c8b32bdc9a37057e6d6babe971ed79" id="r_ab9c8b32bdc9a37057e6d6babe971ed79"><td class="memItemLeft" align="right" valign="top">Eigen::VectorXd&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ab9c8b32bdc9a37057e6d6babe971ed79">compute_similarity_obs</a> (int obs_idx) const override</td></tr>
<tr class="memdesc:ab9c8b32bdc9a37057e6d6babe971ed79"><td class="mdescLeft">&#160;</td><td class="mdescRight">Counts neighbors of an observation grouped by cluster membership.  <br /></td></tr>
<tr class="separator:ab9c8b32bdc9a37057e6d6babe971ed79"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abec7f01e47f43f09758a872bd4ae316c" id="r_abec7f01e47f43f09758a872bd4ae316c"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#abec7f01e47f43f09758a872bd4ae316c">compute_similarity_cls</a> (int cls_idx, bool old_allo=false) const override</td></tr>
<tr class="memdesc:abec7f01e47f43f09758a872bd4ae316c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Counts internal edges within a cluster.  <br /></td></tr>
<tr class="separator:abec7f01e47f43f09758a872bd4ae316c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a79fa7cb352dd2f54f5d31eabe6f0f4a1" id="r_a79fa7cb352dd2f54f5d31eabe6f0f4a1"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a79fa7cb352dd2f54f5d31eabe6f0f4a1">compute_similarity_obs</a> (int obs_idx, int cls_idx) const override</td></tr>
<tr class="memdesc:a79fa7cb352dd2f54f5d31eabe6f0f4a1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Counts neighbors of an observation within a specific cluster.  <br /></td></tr>
<tr class="separator:a79fa7cb352dd2f54f5d31eabe6f0f4a1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_classModule"><td colspan="2" onclick="javascript:dynsection.toggleInherit('pub_methods_classModule')"><img src="closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="classModule.html">Module</a></td></tr>
<tr class="memitem:a4b1fffbc65ffbf0ca18f7d59394bd46d inherit pub_methods_classModule" id="r_a4b1fffbc65ffbf0ca18f7d59394bd46d"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModule.html#a4b1fffbc65ffbf0ca18f7d59394bd46d">Module</a> (const Eigen::VectorXi *old_allocations_provider_=nullptr, const std::unordered_map&lt; int, std::vector&lt; int &gt; &gt; *old_cluster_members_provider_=nullptr)</td></tr>
<tr class="separator:a4b1fffbc65ffbf0ca18f7d59394bd46d inherit pub_methods_classModule"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae2d6ab39a4ca2a2dc888cf0cc46de467 inherit pub_methods_classModule" id="r_ae2d6ab39a4ca2a2dc888cf0cc46de467"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModule.html#ae2d6ab39a4ca2a2dc888cf0cc46de467">set_old_allocations_provider</a> (const Eigen::VectorXi *provider)</td></tr>
<tr class="separator:ae2d6ab39a4ca2a2dc888cf0cc46de467 inherit pub_methods_classModule"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9c8d7f09eee2f06c8c8134888b584402 inherit pub_methods_classModule" id="r_a9c8d7f09eee2f06c8c8134888b584402"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModule.html#a9c8d7f09eee2f06c8c8134888b584402">set_old_cluster_members_provider</a> (const std::unordered_map&lt; int, std::vector&lt; int &gt; &gt; *provider)</td></tr>
<tr class="separator:a9c8d7f09eee2f06c8c8134888b584402 inherit pub_methods_classModule"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4a48538d35a2da7fcc32d9f509034723 inherit pub_methods_classModule" id="r_a4a48538d35a2da7fcc32d9f509034723"><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModule.html#a4a48538d35a2da7fcc32d9f509034723">~Module</a> ()=default</td></tr>
<tr class="separator:a4a48538d35a2da7fcc32d9f509034723 inherit pub_methods_classModule"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pro-methods" name="pro-methods"></a>
Protected Member Functions</h2></td></tr>
<tr class="memitem:a838c7393c68a6670ef16a7fd311b88b9" id="r_a838c7393c68a6670ef16a7fd311b88b9"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a838c7393c68a6670ef16a7fd311b88b9">neighbor_cache_compute</a> ()</td></tr>
<tr class="memdesc:a838c7393c68a6670ef16a7fd311b88b9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Precomputes and stores neighbor indices for all observations.  <br /></td></tr>
<tr class="separator:a838c7393c68a6670ef16a7fd311b88b9"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pro-attribs" name="pro-attribs"></a>
Protected Attributes</h2></td></tr>
<tr class="memitem:a50166acdc6f0c6678279b677903d21e5" id="r_a50166acdc6f0c6678279b677903d21e5"><td class="memItemLeft" align="right" valign="top">std::vector&lt; std::vector&lt; int &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a50166acdc6f0c6678279b677903d21e5">neighbor_cache</a></td></tr>
<tr class="memdesc:a50166acdc6f0c6678279b677903d21e5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Cache storing neighbor indices for each observation.  <br /></td></tr>
<tr class="separator:a50166acdc6f0c6678279b677903d21e5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad607b2c05c585c576b7410dd3bef9f1f" id="r_ad607b2c05c585c576b7410dd3bef9f1f"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="classData.html">Data</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ad607b2c05c585c576b7410dd3bef9f1f">data_module</a></td></tr>
<tr class="memdesc:ad607b2c05c585c576b7410dd3bef9f1f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reference to data object with cluster assignments.  <br /></td></tr>
<tr class="separator:ad607b2c05c585c576b7410dd3bef9f1f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4645e8a94596e6bd60b4b04f633247bd" id="r_a4645e8a94596e6bd60b4b04f633247bd"><td class="memItemLeft" align="right" valign="top">const Eigen::MatrixXi&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a4645e8a94596e6bd60b4b04f633247bd">W</a></td></tr>
<tr class="memdesc:a4645e8a94596e6bd60b4b04f633247bd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reference to adjacency matrix W from covariates.  <br /></td></tr>
<tr class="separator:a4645e8a94596e6bd60b4b04f633247bd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae5e715e3bf1325973de36d322f7645a5" id="r_ae5e715e3bf1325973de36d322f7645a5"><td class="memItemLeft" align="right" valign="top">const double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ae5e715e3bf1325973de36d322f7645a5">spatial_weight</a> = 1.0</td></tr>
<tr class="memdesc:ae5e715e3bf1325973de36d322f7645a5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Weighting factor for spatial similarity.  <br /></td></tr>
<tr class="separator:ae5e715e3bf1325973de36d322f7645a5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pro_attribs_classModule"><td colspan="2" onclick="javascript:dynsection.toggleInherit('pro_attribs_classModule')"><img src="closed.png" alt="-"/>&#160;Protected Attributes inherited from <a class="el" href="classModule.html">Module</a></td></tr>
<tr class="memitem:a13d00f3268f377c1d7cc5bf23cf2ce3a inherit pro_attribs_classModule" id="r_a13d00f3268f377c1d7cc5bf23cf2ce3a"><td class="memItemLeft" align="right" valign="top">const Eigen::VectorXi *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModule.html#a13d00f3268f377c1d7cc5bf23cf2ce3a">old_allocations_provider</a></td></tr>
<tr class="memdesc:a13d00f3268f377c1d7cc5bf23cf2ce3a inherit pro_attribs_classModule"><td class="mdescLeft">&#160;</td><td class="mdescRight">Provider function for accessing old allocation state.  <br /></td></tr>
<tr class="separator:a13d00f3268f377c1d7cc5bf23cf2ce3a inherit pro_attribs_classModule"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a98c96fd42dbc1df8484b0de586fd2bd6 inherit pro_attribs_classModule" id="r_a98c96fd42dbc1df8484b0de586fd2bd6"><td class="memItemLeft" align="right" valign="top">const std::unordered_map&lt; int, std::vector&lt; int &gt; &gt; *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModule.html#a98c96fd42dbc1df8484b0de586fd2bd6">old_cluster_members_provider</a></td></tr>
<tr class="memdesc:a98c96fd42dbc1df8484b0de586fd2bd6 inherit pro_attribs_classModule"><td class="mdescLeft">&#160;</td><td class="mdescRight">Provider function for accessing old cluster members map.  <br /></td></tr>
<tr class="separator:a98c96fd42dbc1df8484b0de586fd2bd6 inherit pro_attribs_classModule"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p><a class="el" href="classModule.html" title="Abstract base class for modules used in clustering processes. This class defines the interface for mo...">Module</a> providing spatial methods for processes utilizing spatial information. </p>
<p>This class offers utility functions to compute neighbor counts based on an adjacency matrix W, facilitating the incorporation of spatial dependencies in clustering algorithms. The neighbor relationships are cached at construction time for efficient repeated access. </p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a239a34ffe181cd9434d5087b821d4b4d" name="a239a34ffe181cd9434d5087b821d4b4d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a239a34ffe181cd9434d5087b821d4b4d">&#9670;&#160;</a></span>SpatialModule()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">SpatialModule::SpatialModule </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classData.html">Data</a> &amp;</td>          <td class="paramname"><span class="paramname"><em>data_</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Eigen::MatrixXi</td>          <td class="paramname"><span class="paramname"><em>W_</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>spatial_coeff</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Eigen::VectorXi *</td>          <td class="paramname"><span class="paramname"><em>old_alloc_provider</em></span><span class="paramdefsep"> = </span><span class="paramdefval">nullptr</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::unordered_map&lt; int, std::vector&lt; int &gt; &gt; *</td>          <td class="paramname"><span class="paramname"><em>old_cluster_members_provider_</em></span><span class="paramdefsep"> = </span><span class="paramdefval">nullptr</span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Constructs a <a class="el" href="classSpatialModule.html" title="Module providing spatial methods for processes utilizing spatial information.">SpatialModule</a> with parameter and data references. </p>
<p>Initializes the neighbor cache by calling <a class="el" href="#a838c7393c68a6670ef16a7fd311b88b9" title="Precomputes and stores neighbor indices for all observations.">neighbor_cache_compute()</a>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">data_</td><td>Reference to the <a class="el" href="classData.html" title="Manages distance matrices and cluster allocations for points.">Data</a> object with cluster assignments. </td></tr>
    <tr><td class="paramname">W_</td><td>Reference to the adjacency matrix W. matrix. </td></tr>
    <tr><td class="paramname">spatial_coeff</td><td>Weighting factor for spatial similarity. </td></tr>
    <tr><td class="paramname">old_alloc_provider</td><td>function to access old allocations for split-merge. </td></tr>
    <tr><td class="paramname">old_cluster_members_provider_</td><td>function to access old cluster members for split-merge. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="abec7f01e47f43f09758a872bd4ae316c" name="abec7f01e47f43f09758a872bd4ae316c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abec7f01e47f43f09758a872bd4ae316c">&#9670;&#160;</a></span>compute_similarity_cls()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double SpatialModule::compute_similarity_cls </td>
          <td>(</td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>cls_idx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool</td>          <td class="paramname"><span class="paramname"><em>old_allo</em></span><span class="paramdefsep"> = </span><span class="paramdefval">false</span>&#160;) const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel override">override</span><span class="mlabel virtual">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Counts internal edges within a cluster. </p>
<p>Computes the number of edges where both endpoints belong to the specified cluster. This is calculated as: (1/2) * sum_{i,j in cluster} <a class="el" href="#a4645e8a94596e6bd60b4b04f633247bd" title="Reference to adjacency matrix W from covariates.">W(i,j)</a>. The division by 2 accounts for the symmetry of W (each edge counted twice).</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">cls_idx</td><td>The index of the cluster (0 to K-1). </td></tr>
    <tr><td class="paramname">old_allo</td><td>If true, uses old allocations from old_allocations_provider; if false, uses current allocations from data_module (default: false). </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The total number of internal edges in the cluster. </dd></dl>

<p>Implements <a class="el" href="classModule.html#acbf529bbbc5b980fc4d6e45e733fc56e">Module</a>.</p>

</div>
</div>
<a id="ab9c8b32bdc9a37057e6d6babe971ed79" name="ab9c8b32bdc9a37057e6d6babe971ed79"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab9c8b32bdc9a37057e6d6babe971ed79">&#9670;&#160;</a></span>compute_similarity_obs() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">Eigen::VectorXd SpatialModule::compute_similarity_obs </td>
          <td>(</td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>obs_idx</em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel override">override</span><span class="mlabel virtual">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Counts neighbors of an observation grouped by cluster membership. </p>
<p>Returns a vector where element k contains the number of neighbors of obs_idx that belong to cluster k.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">obs_idx</td><td>The index of the observation (0 to N-1). </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A K-dimensional vector of neighbor counts per cluster. </dd></dl>

<p>Implements <a class="el" href="classModule.html#aa3b528c6288ac0293a4883cafe422b9b">Module</a>.</p>

</div>
</div>
<a id="a79fa7cb352dd2f54f5d31eabe6f0f4a1" name="a79fa7cb352dd2f54f5d31eabe6f0f4a1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a79fa7cb352dd2f54f5d31eabe6f0f4a1">&#9670;&#160;</a></span>compute_similarity_obs() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double SpatialModule::compute_similarity_obs </td>
          <td>(</td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>obs_idx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>cls_idx</em></span>&#160;) const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel override">override</span><span class="mlabel virtual">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Counts neighbors of an observation within a specific cluster. </p>
<p>Uses the cached neighbor list to efficiently count how many neighbors of observation obs_idx belong to cluster cls_idx.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">obs_idx</td><td>The index of the observation (0 to N-1). </td></tr>
    <tr><td class="paramname">cls_idx</td><td>The index of the cluster to consider for neighbor counting. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The number of neighbors for the observation in the specified cluster. </dd></dl>

<p>Implements <a class="el" href="classModule.html#aad8d336592403c3b2546883d2b93a1fe">Module</a>.</p>

</div>
</div>
<a id="a838c7393c68a6670ef16a7fd311b88b9" name="a838c7393c68a6670ef16a7fd311b88b9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a838c7393c68a6670ef16a7fd311b88b9">&#9670;&#160;</a></span>neighbor_cache_compute()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void SpatialModule::neighbor_cache_compute </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel protected">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Precomputes and stores neighbor indices for all observations. </p>
<p>This method initializes neighbor_cache by extracting non-zero entries from each row of the adjacency matrix W. Called once during construction to enable O(neighbors) instead of O(N) lookup time. </p>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="ad607b2c05c585c576b7410dd3bef9f1f" name="ad607b2c05c585c576b7410dd3bef9f1f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad607b2c05c585c576b7410dd3bef9f1f">&#9670;&#160;</a></span>data_module</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="classData.html">Data</a>&amp; SpatialModule::data_module</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel protected">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Reference to data object with cluster assignments. </p>

</div>
</div>
<a id="a50166acdc6f0c6678279b677903d21e5" name="a50166acdc6f0c6678279b677903d21e5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a50166acdc6f0c6678279b677903d21e5">&#9670;&#160;</a></span>neighbor_cache</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;std::vector&lt;int&gt; &gt; SpatialModule::neighbor_cache</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel protected">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Cache storing neighbor indices for each observation. </p>
<p>neighbor_cache[i] contains a vector of indices j where <a class="el" href="#a4645e8a94596e6bd60b4b04f633247bd" title="Reference to adjacency matrix W from covariates.">W(i,j)</a> == 1. This avoids repeatedly scanning the full adjacency matrix during MCMC sampling. </p>

</div>
</div>
<a id="ae5e715e3bf1325973de36d322f7645a5" name="ae5e715e3bf1325973de36d322f7645a5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae5e715e3bf1325973de36d322f7645a5">&#9670;&#160;</a></span>spatial_weight</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const double SpatialModule::spatial_weight = 1.0</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel protected">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Weighting factor for spatial similarity. </p>

</div>
</div>
<a id="a4645e8a94596e6bd60b4b04f633247bd" name="a4645e8a94596e6bd60b4b04f633247bd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4645e8a94596e6bd60b4b04f633247bd">&#9670;&#160;</a></span>W</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const Eigen::MatrixXi SpatialModule::W</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel protected">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Reference to adjacency matrix W from covariates. </p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>src/processes/module/<a class="el" href="spatial__module_8hpp_source.html">spatial_module.hpp</a></li>
<li>src/processes/module/<a class="el" href="spatial__module_8cpp.html">spatial_module.cpp</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.13.2-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="classSpatialModule.html">SpatialModule</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.13.2 </li>
  </ul>
</div>
<script type="text/javascript" src="doxygen-awesome-darkmode-toggle.js"></script>
<script type="text/javascript">
    DoxygenAwesomeDarkModeToggle.init()
</script>
</body>
</html>
